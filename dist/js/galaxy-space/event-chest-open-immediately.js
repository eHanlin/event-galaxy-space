"use strict";define(["jquery","ajax","confirmPopup","eventChestInspection"],function(e,n,t,o){var c={ask:function(e,o){var s=void 0;n("GET","/chest/coolDownTime/"+e.id).then(function(e){return s=e.content,n("GET","/chest/condition/openImmediately")}).then(function(n){var i,r=n.content.content,a=parseInt(r.secondsCycle),u=r.spendGems;i='\n            <div>\n              <h2 class="header-text">立即開啟寶箱需花費 '+(u*=Math.ceil(s/a))+" 個寶石</h2>\n              <h3>確定要立即開啟寶箱嗎？</h3>\n            </div>\n          ",t.dialog(i,c.process.bind(c.process,e,o,u))})},process:function(c,s,i){n("GET","/chest/checkBalance?gems="+i).then(function(o){var s=o.content;if(s){return t.ok("Oooooops 餘額不足喔！",s),e.Deferred().reject().promise()}return n("PUT","/chest/open/immediately/"+c.id,{spendGems:i})}).then(function(n){if(!o(n.message,n.content)){var t=n.content.finalGems;require(["eventCountUp"],function(n){n("gems",parseInt(e("#gems").text()),t)}),require(["eventCountdown","eventChestReady"],function(e,n){e(0,c,s,n)})}})}};return c});