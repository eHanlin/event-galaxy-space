"use strict";define(["jquery","ajax","confirmPopup","eventChestInspection"],function(e,n,t,o){var c={ask:function(e,o){var i=void 0;n("GET","/chest/coolDownTime/"+e.id).then(function(e){return i=e.content,n("GET","/chest/condition/openImmediately")}).then(function(n){var s,r=n.content.content,a=parseInt(r.secondsCycle),u=r.spendGems;s='\n            <div>\n              <h2 class="header-text">立即開啟寶箱需花費 '+(u*=Math.ceil(i/a))+" 個寶石</h2>\n              <h3>確定要立即開啟寶箱嗎？</h3>\n            </div>\n          ",t.dialog(s,{confirmFn:c.process.bind(c.process,e,o,u)})})},process:function(c,i,s){n("GET","/chest/checkBalance?gems="+s).then(function(o){var i=o.content;if(i){return t.ok("Oooooops 餘額不足喔！",i),e.Deferred().reject().promise()}return n("PUT","/chest/open/immediately/"+c.id,{spendGems:s})}).then(function(n){if(!o(n.message,n.content)){var t=n.content.finalGems;require(["eventCountUp"],function(n){n("gems",parseInt(e("#gems").text()),t)}),require(["eventCountdown","eventChestReady"],function(e,n){e(0,c,i,n)})}})}};return c});