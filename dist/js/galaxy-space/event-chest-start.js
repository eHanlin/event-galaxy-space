"use strict";define(["jquery","ajax","confirmPopup","eventStatusDo","w3"],function($,ajax,confirmPopup,eventStatusDo,w3){return function(chest,targets){var content=void 0,statusData={status:"UNLOCKING"};content=chest.level>=2?'\n        <div class="start-confirm-grid-container">\n          <div class="content-block1">\n            <span>寶箱準備啟動中...</span>\n          </div>\n  \n          <div class="content-block2">\n            <span>目前寶箱等級為Lv'+chest.level+'，開啟這個寶箱可能獲得</span>\n          </div>  \n          <div class="img-block-left-btn">\n            <img class="left-btn" src="https://d220xxmclrx033.cloudfront.net/event-galaxy-space/img/previous.png">\n          </div>\n  \n          <div class="img-block-right-btn">\n            <img class="right-btn" src="https://d220xxmclrx033.cloudfront.net/event-galaxy-space/img/next.png">\n          </div>\n  \n          <div class="content-block4">\n            <span>你確定要啟動這個寶箱嗎？</span>\n          </div>\n        </div>\n      ':'\n        <div>\n          <h2 class="header-text">寶箱準備啟動中...</h2>\n          <h3>你確定要啟動這個寶箱嗎？</h3>\n        </div>\n      ',confirmPopup.dialog(content,function(){ajax("PUT","/chest/status/"+chest.id,statusData).then(function(jsonData){"Status of chest is already change"!==jsonData.message?eventStatusDo.unLocking(chest,targets):confirmPopup.ok("Oooooops！","此次寶箱操作，重複進行囉！")})},function(){},function(){chest.level<2||ajax("GET","/chest/condition/chest"+chest.level).then(function(data){var awards=data.content.content.awards,chestMatchAwards=void 0,awardsCount=awards.length,limit=0,awardIndex=void 0,awardImages="",awardBlock="";limit=window.matchMedia("(max-width: 500px)").matches?1:window.matchMedia("(max-width: 800px)").matches?3:5;var composeAwardBlock=function(awardIndex,limit,chestMatchAwards){switch(awardIndex%limit){case limit-1:awardBlock+='<div class="img-block-award">'+(awardImages+='<img class="img-award'+awardIndex+'" src="https://d220xxmclrx033.cloudfront.net/event-galaxy-space/img/award/'+chestMatchAwards+'.png">')+"</div>",awardImages="";break;default:awardImages+='<img class="img-award'+awardIndex+'" src="https://d220xxmclrx033.cloudfront.net/event-galaxy-space/img/award/'+chestMatchAwards+'.png">'}};for(awardIndex=0;awardIndex<awards.length;awardIndex++)chestMatchAwards=awards[awardIndex],awardIndex===awardsCount-1?awardBlock+='<div class="img-block-award">'+(awardImages+='<img class="img-award'+awardIndex+'" src="https://d220xxmclrx033.cloudfront.net/event-galaxy-space/img/award/'+chestMatchAwards+'.png">')+"</div>":composeAwardBlock(awardIndex,limit,chestMatchAwards);$(".img-block-left-btn").after(awardBlock);var slide=w3.slideshow(".img-block-award",0);$(".right-btn").on("click",function(){slide.next()}),$(".left-btn").on("click",function(){slide.previous()})})})}});